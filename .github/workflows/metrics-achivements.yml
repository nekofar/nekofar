name: Metrics (Achievements)

on:
  # Schedule updates (each hour)
  schedule: [{ cron: "0 1 * * *" }]
  # Lines below let you run workflow manually and on each commit
  workflow_dispatch:
  push: { branches: ["master", "main"] }

jobs:
  # üèÜ Achievements
  plugin-achivements:
    name: Achievements
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: plugin achievements
        uses: nekofar/metrics@master
        with:
          token: ${{ secrets.METRICS_TOKEN }}
          base: ""
          base_indepth: yes
          repositories: 500
          repositories_batch: 100
          repositories_forks: yes
          repositories_affiliations: owner, collaborator, organization_member
          config_timezone: Asia/Tehran
          filename: assets/metrics.plugin.achievements.svg
          use_prebuilt_image: yes
          committer_message: |
            chore(metrics): update `${filename}`
            
            [Skip GitHub Action]
          plugin_achievements: yes
          plugin_achievements_threshold: C # Display achievements with rank B or higher
          plugin_achievements_secrets: yes # Display unlocked secrets achievements
          plugin_achievements_ignored: "" # Hide octonaut achievement
          plugin_achievements_limit: 0 # Display all unlocked achievement matching threshold and secrets params
          plugin_achievements_display: detailed # Use compact display